<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.culture.demo.mapper.FaqMapper">
	
	<!-- 조건 있는 자주 묻는 질문 조회
	public List<FaqDTO> getSeacrchFaqList(int faq_tp_id, String q) -->
	<select id="getSeacrchFaqList" resultType="com.culture.demo.domain.FaqDTO">
		SELECT f.faq_sq, t.faq_tp_id, f.faq_title, f.faq_content
	    FROM faq f JOIN faq_type t ON f.faq_tp_id = t.faq_tp_id
	    <where>
	      <if test='faq_tp_id > 0'>
	        WHERE t.faq_tp_id = #{t.faq_tp_id}
	      </if>
	      <if test='q != null and q != ""'>
	        <if test='faq_tp_id > 0'>
	          AND
	        </if>
	        REGEXP_LIKE(f.faq_content, #{q}, 'i')
	      </if>
	    </where>
	</select>
	
	
	<!-- 조건 없는 자주 묻는 질문 조회
	public List<FaqDTO> getFaqAllList(int faqTpId); -->
	<select id="getFaqAllList" resultType="com.culture.demo.domain.FaqDTO">
	    SELECT f.faq_sq, t.faq_tp_id, f.faq_title, f.faq_content
	    FROM faq f
	    JOIN faq_type t ON f.faq_tp_id = t.faq_tp_id
	</select>

	<!-- 선택 목록 조회
	public List<FaqDTO> getFaqList(int faq_tp_id); -->
	<select id="getFaqList" resultType="com.culture.demo.domain.FaqDTO">
		SELECT f.faq_sq, t.faq_tp_id, f.faq_title, f.faq_content
		FROM faq f
		JOIN faq_type t ON f.faq_tp_id = t.faq_tp_id
		f.faq_tp_id = #{faq_tp_id}
	</select>

</mapper>